--------------------------------------------------------------------------------
Patch Notes
--------------------------------------------------------------------------------
Version .07.13 December/06/2019
--------------------------------------------------------------------------------
Updated library for FindText() function
    Lib now offers ways of capturing and manipulating screenshots
        using this I have reduced the delay of the OHB from +400MS to ~100MS
        incidentally this also fixes issues with the healthbar quickly moving
    Lib has improved edit menu that remains the same size when scaling area
        you can now scroll the edit panel to select the correct pixels
    Can now assign a screenshot hotkey in the findtext GUI
        grab a screenshot and go back to capture buffs / debuffs later
    Can now test strings straight from the clipboard

General adjustments for other parts of the scripts that use FindText()
    Coordinate input has been adjusted to match the new format
    GGF script finally utilizes variables coming from the Rescale function
        Should allow for people using a secondary monitor to play the game

Opening the FindText GUI is now its own thread seperated from the main script
    This allows for using the screenshot feature without it being overwritten
    Pressing escape will exit the app while its active, closing the window as well
        Minimize allows you to keep it open for using the screenshot hotkey

Introducing Advanced Hotkeys library for easier binding of hotkeys
    as a proof of concept I have modified the FindText lib Screnshot hotkey to use this
    Double click on the binding editbox to bring up the hotkey assignment window

Also added DynaRun and CreateScript in library for later use
    These allow for scripts which can be run in a seperate thread

Version .07.12 December/03/2019
--------------------------------------------------------------------------------
Reworked how the Id/Vend/Stash hotkey starts
    Now scans for just OnChar and OnInventory at very start
    Using the location status it determines if it should look for the stash
    Searching for vendor after stash now only happens in hideout
        thinking of adding vendors for each town to use in town as well
    now opens inventory nearly instantly when out in the field
        press twice to open inventory and then Id everything

Fix for CLF edit menu and Export msgbox not being AlwaysOnTop
    Will once again display over the main window

Warning for Missing Client.txt file is now always on top

Fresh install will default to Client text in steam library on the C: drive

Big thanks to tsivilay for their contribution of a reworked log parser!
    They have created an alternative method of gathering the current location
    Massively faster than the previous method, measuring in MicroSeconds
    Now it checks all lines since the last loop, and should ALWAYS capture changes
        Because of this, the loop can run at a much slower rate
    Removed some of the old code that is not needed

Version .07.11 December/01/2019
--------------------------------------------------------------------------------
Bugfix for assigning the file object when loading an alternate Client.txt 
    Realized the file object was being assigned before INI load
    Now assigns after INI load
    Checks for valid Client.txt when Selected/Edited in the GUI
        If it finds a valid file, it will assign it as the new File Object

Error function has been converted to a voradic function and renamed Log()
    can now receive any number of variables as messages
    Output file will now be Log.txt
    Auto-Quit now writes to the log

Version .07.10 November/29/2019
--------------------------------------------------------------------------------
Another attempt to resolve issues with Client Log parser.
    Possible issue with overlapping timers on scan
        Thread, NoTimers, true
        should hopefully resolve this issue
    Added new debug messages option, C Log for location output
        Will display the OnTown, OnHideout, and OnMines status
        Will also display the Location string that was evaluated

Updated 1080 strings for Auto Skillup and Stash
    Clicks stash and not Guild Stash
    Only click Skills that can level up, ignoring greyed out ones
    Make sure you update strings in the Strings Tab
        Open the dropdown list for Capture of the Stash, select new default
        Open the dropdown list for Capture of the Skill up icon, select new default

Fix for Auto-Quicksilver overlay not showing up in the correct location
    Was affecting script when opened while game was closed

Version .07.09 November/29/2019
--------------------------------------------------------------------------------
Switched out the ASM tail function with AHK fileobject function
    Nearly as fast, and seems to be more reliable

Version .07.08 November/27/2019
--------------------------------------------------------------------------------
New options for Auto-Quit at 50% and 60% 

Bugfix for PortalQuit
    Forgot to properly initialize the LastLogout variable

The GUI overlay now hides/shows nearly instantly when game is not active

Scan MS setting will no longer show tooltips when game is not active

Version .07.07 November/27/2019
--------------------------------------------------------------------------------
Bugfix for PortalQuit to wait 30 seconds after firing
    Was causing issues when you died, it would keep trying to portal out

Bugfix for memory issue of > 64 mb logfile
    Increased the memory limit of variables to 256 mb
    Massive improvements to the Client Log reading method
    From upwards of .188 seconds its now operating at .0007 seconds or less
    No longer loads the file into memory, now uses a FileObject instead
    The script is still using 42MB because of the different arrays it is using
        To really optimize I would need to rewrite all the arrays into classes/obj

Additions to the library:
    CoolTime - Allows for more precise display of MS of an action - to swap later
    ASMLastLine - Grabs the tail of the file using asembly code, for speed
    LastLineInit - Set the marker to the end of a FileObject

Version .07.06 November/25/2019
--------------------------------------------------------------------------------
New method of Auto-Quit is now available, leave by portaling out!
    Got the idea when adding the option to auto click portal
    Can now choose to exit area by means of portal instead of D/C or /exit
    Obviously will be much slower than instant D/C
        Use caution when using a low setting like 20%
    If using PortalQuit and inside the Town, Hideout or Mines, Logout hotkey will D/C

New Options for the Quick-Portal hotkey
    Can now choose to auto-click the portal after opening it
    Can now choose to re-open the map overlay after opening portal

Bugfix for GottaGoFast gui not displaying properly
    Also fixes the hidden window appearing named NoActivate
    Somehow it was showing two GUI for the script

New option to Relog into the game after Auto-Quit or Logout hotkey

Forgot to mention in last patchnotes:
    Stash hotkeys has a new binding to reset the current tab
    This is for when you have moved the stash tab to a new location manually

Version .07.05 November/24/2019
--------------------------------------------------------------------------------
New setting in the Configuration Tab to point to your Client.txt location
    Its set up for steam client on C: drive, but simply locate your own otherwise
    Will pause the script when entering town or hideout, and switch on OHB in mines
    Automatically scans log for location at start, and anytime you zone
    
*** Script will prompt the user if they do not have a valid Client.txt Location ***

GuiStatus has been reduced from 280 ms to just over 100 ms
    Half of the status checks have been moved out of the Flask logic
    Only the Id/Vend/Stash hotkey will check for Stash, Div and Vendor
    OnHideout, OnMines, OnTown is now handled by the Client log
        OnHideout and OnHideoutMin are no longer necessary, and has been removed

Discovered that the FindText library will only work for others running on 1080 Height
    This means OHB, Find Stash, and Vendor after stash are affected
    To fix this, I Introduced a new Strings Tab for custom FindText strings
        Use the dropdown list to Select the 1080 defaults, or paste in your own
        Capture the strings by clicking the Get Icon button, adjust the w/h and go
        If setting huge width (max) set height to something low (20) so it wont crash
            These extreme values are there if someone is using huge resolutions
        Most of the time to capture a simple text, w = 30 , h = 15 , are good values

Fixes for Overhead Health Bar
    OHB detection now only occurs within the center area of the screen
        Fixes false matches that will occur on the sides and bottom
    OHB now scales based on the string's pixel width
        Enter your custom string in the Strings Tab
        Width should end up as an even number
    OHB Percentage logic now checks to determines if OHB itself moved/gone
        Finally fixed a lot of the false negatives

"Use OHB for health?" is now "Switch to OHB for Delve?"
    Setting now determines if you switch into OHB while in Azurite Mines
    Use Auto-Quit at your discretion, can have false negatives on rare occasion

Added loading tooltips when starting the script

Cleaning up in the GottaGoFast script, implimented library and removed clutter
    Now always uses the ReadFromFile() instead of two INI load sections
    Duplicate functions from Library have been removed

Version .07.04 November/19/2019
--------------------------------------------------------------------------------
New Automation Options in the Inventory Tab for the Id/Vend/Stash hotkey
    Enable "search for stash" to find the stash on screen if no panels are open
        If found it will wait to walk and open the Stash, then proceed to sort
    Enable "Move to vendor after stash" to find vendor and click after Stashing
        Only goes to vendor if there are items left over in inventory
        Select which master string it searches for from the 3 options
            MasterStr is for any of the Masters
            NavaliStr is for Navali
            HelenaStr is for Helena
        A Vendor must be visible from the stash location (on same screen)
            If using MasterStr will click the first it finds

Rework of the item sort function to allow chaining actions
    Identify, Vendor, Stash, and Divination have been given their own functions

Improvement to the MoveStash function
    First tab it goes to always uses the old method to make sure of starting point
        Tabs after the first use the left and right arrows to make it much faster
        If the tab is over 20 spaces away it will reselect in the dropdownlist

Other fixes for GUI being always on top
    Custom Loot Filter GUI is now AlwaysOnTop as well

Added tooltips to the Stash Management section of the Inventory Tab

Bulk vendor function has been drastically improved and is much more accurate
    20 quality flask are treated as 40 quality for sorting purposes
    Flasks/Gems are grouped as close to 40 as possible
    Once they are sorted it will vendor them in the order of each group
    Also provides more information about the total values
        gives the total quality, orb value, grouped q, excess q, and un-used q
    Is more accurate with many at once, but will always get a valid result

Fix for GUI showing twice if game was open and Show GUI on Startup was checked

Fix for items being missed sometimes
    Random click area was a little too large, tightened up by 10 pixels
    Also added a little delay between clicks when going through grouped items

Version .07.03 November/14/2019
--------------------------------------------------------------------------------
Calibration section has been restructured
    Added optional calibration to resample the OHB health color
        Default health color is now provided in the INI load
        fixes a bug when loading from hideout to map directly on top of the Portal
        Only occured when first scan of the OHB was in the map after being in H.O.
        This will ensure a consistent sample for comparison
    Individual Samples have been given a button that opens their own GUI
    The ? button has been improved since it was showing up behind the GUI

Similarity of the OHB string has been reduced to 97 from 98
    Seems to reduce the amount of "OHB moved before scan" errors
    only seemed to be an issue when there are spell effects directly below OHB

Version .07.02 November/12/2019
--------------------------------------------------------------------------------
Debug messages have been improved
    Now can have optional readout of the MS time
        Enable Scan MS which appears when Debug Messages is enabled
    Mostly for displaying issues with the OHB
    The checkboxes have been moved out of the tabs and into main window
        you can now access them from any tab

Adjustments to the OHB's movement check 
    instead of doing a pixelgetcolor it instead uses PixelSearch
    This is to prevent color matching issues (when ES covers but then is gone)
    adds a few MS to health scan, but fixes issues with reliability

Rework of the RemoveToolTip label into a function group
    Ding tooltips assigned to specific tooltip # have independent timers
    Allows some tooltips to refresh quickly while others can have longer timeout

Version .07.01 November/11/2019
--------------------------------------------------------------------------------
Found another issue with the OHB moving
    If the OHB moved the MS that the scan starts, but moved back in < than 15 ms
    Added another pixel check at the moment OHB health check starts to catch this
    Seems to have worked, am no longer getting DC's when using dash etc..

--------------------------------------------------------------------------------
Release Notes 
--------------------------------------------------------------------------------
Version .07.00 November/10/2019
--------------------------------------------------------------------------------
Major Additions in this version:
    
Utility section can now check for a buff icon!
    To use this new feature set up a Utility hotkey 
    Disable QS, Life, or ES checks or they will override this
    duration is how often to check if the buff is present, keep this above 150
    Enter a string created with the Icon GUI tool

Utility Icon string is captured using the ASCII Image conversion tool GUI
    Adjust the Width or height to capture a different area around the mouse
    The default settings and Tool (Color) are selected for you
    Select a bright color then Click Color2Two to see result
        Dark squares are the match areas, white squares are not matching
        If you do not get a good capture, cancel and retry
        Adjust the Similarity slider +/- to dial in the best match
        It is best not to use dark colors with low Similarity
        Once you have a good match, click auto to trim the blank area
        To finish this all up, Add a comment and then click ok
    Click test to see if the capture will work, ensure no extra matches.
    Click copy to finish, then paste into the Icon editbox for that Utility

New Overhead Health Bar function that Finally fixes issues with Delve Darkness!
        Automatically finds the OHB since its constantly moving
        Function estimates the Health percentage based on where it was last found
            Unfortunately we cannot use PixelSearch fast mode going right to left
        All action logic triggers together when reaching a new HP percent

Since the last major release number there have been several changes:

    Mana threshold can now be adjusted
    Added support for Eldritch Battery builds
    Added support for non default flask hotkeys
        Supports extra buttons when fired, like "1 r" fires 1 and r
    Pop Flask hotkey can now selectively fire flask slots
    Vendor logic adjusted for Quality flasks and Gems in bulk
    New stash tabs for Crafting item bases and Veiled items
    Loot Vacuum can now pick up items in a large area, but ignores buffs at top
    Loot Vacuum can now have custom saved colors in its config GUI
        Can also adjust the AreaScale and Delay here
    New function to auto level up skill gems
    Can now pause auto-detonate by double tapping the detonate key "d"

New Supported Resolution Ratios:

    21:9 and 4:3

Improvements to several of the key functions of the script:

    Item Sort has been improved with new grouping methods
    Item Parser has been tweaked and added to
    Menu GUI has been cleaned up and improved visually
    Attack key functions have been improved
    The main GUI is now set to AlwaysOnTop

--------------------------------------------------------------------------------
Patch Notes
--------------------------------------------------------------------------------
Version .07.00 November/10/2019
--------------------------------------------------------------------------------
New feature for the Utility function
    Configure a Buff Icon string and paste into the editbox
    When its CD expires, will check if the buff icon is present
        If there is no buff icon it will recast
        otherwise places it back on CD
    This only works when that utility is not tied to QS, Life, or ES

New Function that fixes Delve darkness issues for hybrid and life
    Enable the Overhead Health Bar to scan the OHB instead of health globe
    This is another wonderful feature enabled by the FindText Library
    Scans the screen for an ASCII representation of colors
    In my testing it was capturing the OHB in 140-250ms
    It took a lot of trial and error to find the best color
        And now I know! It's the color between both mana and health reserved
        When captured correctly it creates a 2 x 104 pixel bar
        It matched the Healthbar across every character type & reserved state
    I set up the offsets for Mana, ES, Eldritch Battery for later use

The main GUI is now set to AlwaysOnTop
    Decided it makes it easier to use the menu while moving around
    Hit Escape to exit the menu when it is focused

Fix for parsing items from the Chat window

Adjustment to loot vacuum
    the search area is now clamped to the Gameplay area
    Will not search within the buff area at the top of screen

Adjustment to the Right Click menu from the Windows taskbar
    Removed unnecessary menu options
    Added the Image conversion GUI to the options "Capture new Buff Icon"
    Added Gamestates GUI to the tray menu
    Added Calibration Wizard to the tray menu

Rewrite of the Ding Debug Tooltip function to a variadic function
    Ding(Timeout,MultiTooltip,"AHK ","Maximum ","Of ","20 ","Tooltips",...)
    Can now assign message 1 to specific tooltip #1-20 with MultiTooltip
    Can now set timeout to 0 for a persistant tooltip

Some debug messages have been added for the HP scan and OHB
    Turn off debug messages in the Configuration tab. 

Used the method for tooltip management from FindText library
    Can now support tooltips on any of the GUI's
    Will be adding more of the missing tooltips into the menu later

Adjusted the icon detection for Auto-Skillup
    This will hopefully keep it from trying to click on greyed out skills

Modification to the FindText Library GUI
    Removed extra buttons we will not use, left their functions for later
    Added way to adjust the scale of the capture area.
        High values cause significant delay when reloading the capture GUI
    Default values for color sliders set to 98 instead of 100