--------------------------------------------------------------------------------
Patch Notes
--------------------------------------------------------------------------------
Version .07.08 November/27/2019
--------------------------------------------------------------------------------
New options for Auto-Quit at 50% and 60% 

Bugfix for PortalQuit
    Forgot to properly initialize the LastLogout variable

The GUI overlay now hides/shows nearly instantly when game is not active

Scan MS setting will no longer show tooltips when game is not active

Version .07.07 November/27/2019
--------------------------------------------------------------------------------
Bugfix for PortalQuit to wait 30 seconds after firing
    Was causing issues when you died, it would keep trying to portal out

Bugfix for memory issue of > 64 mb logfile
    Increased the memory limit of variables to 256 mb
    Massive improvements to the Client Log reading method
    From upwards of .188 seconds its now operating at .0007 seconds or less
    No longer loads the file into memory, now uses a FileObject instead
    The script is still using 42MB because of the different arrays it is using
        To really optimize I would need to rewrite all the arrays into classes/obj

Additions to the library:
    CoolTime - Allows for more precise display of MS of an action - to swap later
    ASMLastLine - Grabs the tail of the file using asembly code, for speed
    LastLineInit - Set the marker to the end of a FileObject

Version .07.06 November/25/2019
--------------------------------------------------------------------------------
New method of Auto-Quit is now available, leave by portaling out!
    Got the idea when adding the option to auto click portal
    Can now choose to exit area by means of portal instead of D/C or /exit
    Obviously will be much slower than instant D/C
        Use caution when using a low setting like 20%
    If using PortalQuit and inside the Town, Hideout or Mines, Logout hotkey will D/C

New Options for the Quick-Portal hotkey
    Can now choose to auto-click the portal after opening it
    Can now choose to re-open the map overlay after opening portal

Bugfix for GottaGoFast gui not displaying properly
    Also fixes the hidden window appearing named NoActivate
    Somehow it was showing two GUI for the script

New option to Relog into the game after Auto-Quit or Logout hotkey

Forgot to mention in last patchnotes:
    Stash hotkeys has a new binding to reset the current tab
    This is for when you have moved the stash tab to a new location manually

Version .07.05 November/24/2019
--------------------------------------------------------------------------------
New setting in the Configuration Tab to point to your Client.txt location
    Its set up for steam client on C: drive, but simply locate your own otherwise
    Will pause the script when entering town or hideout, and switch on OHB in mines
    Automatically scans log for location at start, and anytime you zone
    
*** Script will prompt the user if they do not have a valid Client.txt Location ***

GuiStatus has been reduced from 280 ms to just over 100 ms
    Half of the status checks have been moved out of the Flask logic
    Only the Id/Vend/Stash hotkey will check for Stash, Div and Vendor
    OnHideout, OnMines, OnTown is now handled by the Client log
        OnHideout and OnHideoutMin are no longer necessary, and has been removed

Discovered that the FindText library will only work for others running on 1080 Height
    This means OHB, Find Stash, and Vendor after stash are affected
    To fix this, I Introduced a new Strings Tab for custom FindText strings
        Use the dropdown list to Select the 1080 defaults, or paste in your own
        Capture the strings by clicking the Get Icon button, adjust the w/h and go
        If setting huge width (max) set height to something low (20) so it wont crash
            These extreme values are there if someone is using huge resolutions
        Most of the time to capture a simple text, w = 30 , h = 15 , are good values

Fixes for Overhead Health Bar
    OHB detection now only occurs within the center area of the screen
        Fixes false matches that will occur on the sides and bottom
    OHB now scales based on the string's pixel width
        Enter your custom string in the Strings Tab
        Width should end up as an even number
    OHB Percentage logic now checks to determines if OHB itself moved/gone
        Finally fixed a lot of the false negatives

"Use OHB for health?" is now "Switch to OHB for Delve?"
    Setting now determines if you switch into OHB while in Azurite Mines
    Use Auto-Quit at your discretion, can have false negatives on rare occasion

Added loading tooltips when starting the script

Cleaning up in the GottaGoFast script, implimented library and removed clutter
    Now always uses the ReadFromFile() instead of two INI load sections
    Duplicate functions from Library have been removed

Version .07.04 November/19/2019
--------------------------------------------------------------------------------
New Automation Options in the Inventory Tab for the Id/Vend/Stash hotkey
    Enable "search for stash" to find the stash on screen if no panels are open
        If found it will wait to walk and open the Stash, then proceed to sort
    Enable "Move to vendor after stash" to find vendor and click after Stashing
        Only goes to vendor if there are items left over in inventory
        Select which master string it searches for from the 3 options
            MasterStr is for any of the Masters
            NavaliStr is for Navali
            HelenaStr is for Helena
        A Vendor must be visible from the stash location (on same screen)
            If using MasterStr will click the first it finds

Rework of the item sort function to allow chaining actions
    Identify, Vendor, Stash, and Divination have been given their own functions

Improvement to the MoveStash function
    First tab it goes to always uses the old method to make sure of starting point
        Tabs after the first use the left and right arrows to make it much faster
        If the tab is over 20 spaces away it will reselect in the dropdownlist

Other fixes for GUI being always on top
    Custom Loot Filter GUI is now AlwaysOnTop as well

Added tooltips to the Stash Management section of the Inventory Tab

Bulk vendor function has been drastically improved and is much more accurate
    20 quality flask are treated as 40 quality for sorting purposes
    Flasks/Gems are grouped as close to 40 as possible
    Once they are sorted it will vendor them in the order of each group
    Also provides more information about the total values
        gives the total quality, orb value, grouped q, excess q, and un-used q
    Is more accurate with many at once, but will always get a valid result

Fix for GUI showing twice if game was open and Show GUI on Startup was checked

Fix for items being missed sometimes
    Random click area was a little too large, tightened up by 10 pixels
    Also added a little delay between clicks when going through grouped items

Version .07.03 November/14/2019
--------------------------------------------------------------------------------
Calibration section has been restructured
    Added optional calibration to resample the OHB health color
        Default health color is now provided in the INI load
        fixes a bug when loading from hideout to map directly on top of the Portal
        Only occured when first scan of the OHB was in the map after being in H.O.
        This will ensure a consistent sample for comparison
    Individual Samples have been given a button that opens their own GUI
    The ? button has been improved since it was showing up behind the GUI

Similarity of the OHB string has been reduced to 97 from 98
    Seems to reduce the amount of "OHB moved before scan" errors
    only seemed to be an issue when there are spell effects directly below OHB

Version .07.02 November/12/2019
--------------------------------------------------------------------------------
Debug messages have been improved
    Now can have optional readout of the MS time
        Enable Scan MS which appears when Debug Messages is enabled
    Mostly for displaying issues with the OHB
    The checkboxes have been moved out of the tabs and into main window
        you can now access them from any tab

Adjustments to the OHB's movement check 
    instead of doing a pixelgetcolor it instead uses PixelSearch
    This is to prevent color matching issues (when ES covers but then is gone)
    adds a few MS to health scan, but fixes issues with reliability

Rework of the RemoveToolTip label into a function group
    Ding tooltips assigned to specific tooltip # have independent timers
    Allows some tooltips to refresh quickly while others can have longer timeout

Version .07.01 November/11/2019
--------------------------------------------------------------------------------
Found another issue with the OHB moving
    If the OHB moved the MS that the scan starts, but moved back in < than 15 ms
    Added another pixel check at the moment OHB health check starts to catch this
    Seems to have worked, am no longer getting DC's when using dash etc..

--------------------------------------------------------------------------------
Release Notes 
--------------------------------------------------------------------------------
Version .07.00 November/10/2019
--------------------------------------------------------------------------------
Major Additions in this version:
    
Utility section can now check for a buff icon!
    To use this new feature set up a Utility hotkey 
    Disable QS, Life, or ES checks or they will override this
    duration is how often to check if the buff is present, keep this above 150
    Enter a string created with the Icon GUI tool

Utility Icon string is captured using the ASCII Image conversion tool GUI
    Adjust the Width or height to capture a different area around the mouse
    The default settings and Tool (Color) are selected for you
    Select a bright color then Click Color2Two to see result
        Dark squares are the match areas, white squares are not matching
        If you do not get a good capture, cancel and retry
        Adjust the Similarity slider +/- to dial in the best match
        It is best not to use dark colors with low Similarity
        Once you have a good match, click auto to trim the blank area
        To finish this all up, Add a comment and then click ok
    Click test to see if the capture will work, ensure no extra matches.
    Click copy to finish, then paste into the Icon editbox for that Utility

New Overhead Health Bar function that Finally fixes issues with Delve Darkness!
        Automatically finds the OHB since its constantly moving
        Function estimates the Health percentage based on where it was last found
            Unfortunately we cannot use PixelSearch fast mode going right to left
        All action logic triggers together when reaching a new HP percent

Since the last major release number there have been several changes:

    Mana threshold can now be adjusted
    Added support for Eldritch Battery builds
    Added support for non default flask hotkeys
        Supports extra buttons when fired, like "1 r" fires 1 and r
    Pop Flask hotkey can now selectively fire flask slots
    Vendor logic adjusted for Quality flasks and Gems in bulk
    New stash tabs for Crafting item bases and Veiled items
    Loot Vacuum can now pick up items in a large area, but ignores buffs at top
    Loot Vacuum can now have custom saved colors in its config GUI
        Can also adjust the AreaScale and Delay here
    New function to auto level up skill gems
    Can now pause auto-detonate by double tapping the detonate key "d"

New Supported Resolution Ratios:

    21:9 and 4:3

Improvements to several of the key functions of the script:

    Item Sort has been improved with new grouping methods
    Item Parser has been tweaked and added to
    Menu GUI has been cleaned up and improved visually
    Attack key functions have been improved
    The main GUI is now set to AlwaysOnTop

--------------------------------------------------------------------------------
Patch Notes
--------------------------------------------------------------------------------
Version .07.00 November/10/2019
--------------------------------------------------------------------------------
New feature for the Utility function
    Configure a Buff Icon string and paste into the editbox
    When its CD expires, will check if the buff icon is present
        If there is no buff icon it will recast
        otherwise places it back on CD
    This only works when that utility is not tied to QS, Life, or ES

New Function that fixes Delve darkness issues for hybrid and life
    Enable the Overhead Health Bar to scan the OHB instead of health globe
    This is another wonderful feature enabled by the FindText Library
    Scans the screen for an ASCII representation of colors
    In my testing it was capturing the OHB in 140-250ms
    It took a lot of trial and error to find the best color
        And now I know! It's the color between both mana and health reserved
        When captured correctly it creates a 2 x 104 pixel bar
        It matched the Healthbar across every character type & reserved state
    I set up the offsets for Mana, ES, Eldritch Battery for later use

The main GUI is now set to AlwaysOnTop
    Decided it makes it easier to use the menu while moving around
    Hit Escape to exit the menu when it is focused

Fix for parsing items from the Chat window

Adjustment to loot vacuum
    the search area is now clamped to the Gameplay area
    Will not search within the buff area at the top of screen

Adjustment to the Right Click menu from the Windows taskbar
    Removed unnecessary menu options
    Added the Image conversion GUI to the options "Capture new Buff Icon"
    Added Gamestates GUI to the tray menu
    Added Calibration Wizard to the tray menu

Rewrite of the Ding Debug Tooltip function to a variadic function
    Ding(Timeout,MultiTooltip,"AHK ","Maximum ","Of ","20 ","Tooltips",...)
    Can now assign message 1 to specific tooltip #1-20 with MultiTooltip
    Can now set timeout to 0 for a persistant tooltip

Some debug messages have been added for the HP scan and OHB
    Turn off debug messages in the Configuration tab. 

Used the method for tooltip management from FindText library
    Can now support tooltips on any of the GUI's
    Will be adding more of the missing tooltips into the menu later

Adjusted the icon detection for Auto-Skillup
    This will hopefully keep it from trying to click on greyed out skills

Modification to the FindText Library GUI
    Removed extra buttons we will not use, left their functions for later
    Added way to adjust the scale of the capture area.
        High values cause significant delay when reloading the capture GUI
    Default values for color sliders set to 98 instead of 100

Version .06.14 November/04/2019
--------------------------------------------------------------------------------
Massive Improvements to the Custom Loot Filter's usability
    Added new GUI that pops up when creating a new group or editing old one
        Edit the group without needing to reload the entire Main GUI
        Click the Finish button to reload the Main GUI
            When done adding/editing groups dont forget to Save Loot Filter
        or click Delete group to remove from array and reload Main GUI
    Added tooltip to indicate its loading the menu structure
    Added GroupBox around each section to better visualize the layout

Adjustments to the Loot Vacuum
    Added delay option for loot vacuum after finding and clicking an item
        Use the dropdown list to choose the number of MS to sleep after clicking
        Default is now 15 ms (one cycle)
    Default AreaScale is now set to 60 for fresh install
    This should fix the issue people are having with being disconnected

Added new stash tab for Veiled items
    Find its settings in the Inventory Tab
    Default is enabled, disable if you want to keep them in inventory

Improvements to the Auto-Quicksilver script GottaGoFast
    Fix for it seeming to pause the QS for several seconds
    Reformated parts of the flask logic code
        removed extra lines as well as unnecessarily saved vars

Implimented width and height for resonators into the item parser

Version .06.13 November/02/2019
--------------------------------------------------------------------------------
Added a pause function for the Auto-Detonate Mines
    Double tap the detonate key to pause Auto-Detonate, press again to resume

Adjustments to the ingame loot filter for using loot vacuum
    New default colors are 0x6565A3, 0x383877, 0xC4FEF6, 0x99FECC
        Update your loot filters if not already set to custom colors
        I have uploaded the new pack to the github page

This link will allow you to load the filter and edit to your liking
    It now uses slightly redish brown and Yellow as the backgrounds
https://www.filterblade.xyz/?profile=throwawaysfortheplebs&saveState=Wingman&platform=pc

Version .06.12 October/28/2019
--------------------------------------------------------------------------------
Fix for Rescale function to use the width and height of the game window instead
    Adds offsets to inventory panel for using non-primary monitor as game window

Version .06.11 October/28/2019
--------------------------------------------------------------------------------
Added new ratio "Classic" for 4:3 ratio 
    1440 x 1080 or 800 x 600
    
Version .06.10 October/28/2019
--------------------------------------------------------------------------------
Adjusted loot vacuum to break out of loop each time it finds a color
    this will cause it rescan and find the same item to click
    reduces the amount of toggling between two items if close by each other
    Added Loot Vacuum adjustments to the controller functions 

Fix for missing Mouseover colors when checking for Unique items left in inventory
    Now just uses the empty inventory color instead
    also adjusted the sleep timer a bit longer between checking if its stashed

Added Prop.ItemBase to the Loot filter, another oversight
    This will let you filter items more specifically than the Stats.ItemClass

Fix bug which caused error "you are not on character" when using item sort

Version .06.09 October/25/2019
--------------------------------------------------------------------------------
Major improvements to the Loot Vacuum
    AreaScale is now able to go much larger than before
    Can now detect Un-Highlighted Loot backgrounds
    from a value of 0 to 500 for nearly the screen size
        When set to 0 is like before and active mousing over
        when above 0 it scans the area around the mouse +- areascale
    with high areascale it now speed clicks on items across the screen
    AreaScale setting has been moved into the new GUI for Loot Vacuum

New GUI for Loot Vacuum Settings, find it on the Configuration tab
    Check the box to enable or disable the loot vacuum
    Click the button to assign loot colors and adjust the AreaScale
    Can support more or less colors than default, adjust your INI file
        It is not recommended, but add or remove entries in groups of 2
            There are 4 default colors, remove 2 to only search for 1 background
            Or add 2 more to search for a third background, etc...
        Find them in the settings.ini by searching for [Loot Colors]
            First entry is Highlighted color second is non-highlighted
        Once you add or remove entries, hit load and go to loot vacuum settings
            It will now reflect the number of entries from your INI file
            To reset them to default just delete the [Loot Colors] section

Loot filter colors have been adjusted to make them slightly off white/black
    black has +60 red and white has -60 red
    update the loot filter files in your Documents
    This doesn't auto-update, grab the newest FilterBlade.zip file from github
    https://github.com/BanditTech/WingmanReloaded/raw/master/FilterBlade.zip

New functions in library hexArrToStr, toRGBfromBGR and hexGRBtoRGB
    this is for the ability to save and view the colors in the GUI

Version .06.08 October/23/2019
--------------------------------------------------------------------------------
Fix for issue while holding down attack keys not letting main flask logic run
    Inserted main flask logic into the attack key timers 
    Adjusted the main flask logic to allow true/false for doing GuiStatus
    This allows other functions to do their own GuiStatus and call the flask routine
    Main and Secondary attack timers moved inside their respective Functions
        this allows them to share static variables with each other

Reverted the MaximumThreads line
    caused the game to hang as logged out if you pressed one of the flask hotkeys AND hit logout

Version .06.07 October/21/2019
--------------------------------------------------------------------------------
New Feature added to the script that automatically level up your gems!
    Every 1/5 second it checks if there are gems to level and clicks on them
        returns your mouse to the position/state it was before clicking
    Enable this option in the QOL settings on the configuration tab
    ***Does not dermine which gem is leveling, use at your own discretion***

Adjustments to parse backend
    Added support for annointed items
    Added affix Increased Chaos Damage
    added PseudoTotalAddedAvg and PseudoTotalAddedEleAvg to Affix array
        These give you the total added damage on the items affixes
    Fixed Implicits not being parsed because they are possible corruption affix
        Added a failsafe if the item ends up not being corrupted
    Fixed Life + Mana on hit claws not parsing the Implicits
        seems to be the only implicit that has two lines

Adjustments to SendMsg
    With the new matchmode it no longer needs a backup to match the script window

Added detect hidden windows to the POE window check to maybe fix that issue

MaximumThreads increased to 10, may see some slight improvements
    This does not truely enable multiple threads, but attempts to force it

Adjustments to the loot vacuum
    Added AreaScale to GUI for adjustment, will allow to adjust the search size
        Default setting is now 0 which is the fastest setting
            changes to a pixelgetcolor scan on mouse location at setting 0
            now dragging over several items quickly will be picked up better
        when using a controller its better at a setting of 3 or 4
            because its harder to drag the mouse exactly over the background color
    Cleaning up the code, and removing extra steps it was taking
        All calculations are done in-line and no longer save unnecessarily
    Removed the RGB option, now uses BGR like everything else in the script
        This lets you add colors easier using the Coord tool

New function added to the Library called FindText
    Allows for image to be converted to ASCII representation
    Can search for nearly anything as long as it is distinct enough colors
    Using this for the AutoSkillUp timer to search for the + icon

Version .06.06 October/14/2019
--------------------------------------------------------------------------------
New source of Base item information at:
    https://raw.githubusercontent.com/brather1ng/RePoE/master/data/base_items.min.json
    Amulets, rings now parse their base types

New Prop.DropLevel and Prop.CraftingBase added to custom loot filter
    DropLevel is a digit value
    CraftingBase is either 0, "T1", "T2", "T3" based on filterblades tiers

T1: Opal Ring, Steel Ring, Vermillion Ring
T2: Blue Pearl Amulet, Bone Helmet, Cerulean Ring, Convoking Wand, Crystal Belt, 
    Fingerless Silk Gloves, Gripped Gloves, Marble Amulet, Sacrificial Garb, 
    Spiked Gloves, Stygian Vise, Two-Toned Boots, Vanguard Belt
T3: Colossal Tower Shield, Eternal Burgonet, Hubris Circlet, Lion Pelt, 
    Sorcerer Boots, Sorcerer Gloves, Titanium Spirit Shield, Vaal Regalia, 
    Diamond Ring, Onyx Amulet, Two-Stone Ring

New Stash tab option for crafting bases
    Assign the stash tab and leave it enabled or uncheck to disable
    Select the ID/Vend/Stash options which Tiers and rarity are enabled (default on)

Bugfix for Evasion Rating not being parsed correctly
Bugfix for Chance to Block not being parsed correctly

Version .06.05 October/12/2019
--------------------------------------------------------------------------------
Added option to enable Eldritch Battery
    Changes the ES sample from the health globe to the mana globe
    Only works properly when using Hybrid character type
    This option has been added to profiles

Added options for Pop Flasks Hotkey
    Can now choose which flask slots will fire when pressing hotkey
    Affects both modes, Respect CD or forced trigger
    These options have been added to profiles

Fixed a strange bug with mismatching in the ~ evaluator
    Applied the string split to all the fields not just stats
    Should now work as intended in all fields, use | as the delimiter
    Capitalization is not required when using ~
        Otherwise it is required when using = or != evaluator
    ~ evaluator can match any portion of the string its evaluating, Ex. ItemClass:
        to match one hand or two hand just put "hand" in the Min field
        Alternately, match multiple parts "Two | one | dAgGeR"
        or "hand | DAGGER | MACe | Bow"

Changed Title matchmode to 2 from 3
    this is an attempt to fix window title is not being matched
    Possibly fix the error of the SendMsg bug as well

Moved the Ninja Database update after the GUI shows
    This will make the script seem to load faster, but its loading in background
    Possibly fix the error of the SendMsg bug as well

Added a new timer once an hour, it checks if the game is closed and updates Ninja DB
    Will allow the script to stay open and stay up to date in the background
    Assign the interval in the Item Parse tab, from 1-7 days

Improved the ability for the script to determine the amount of days since DB update
    New function added to the Library called DaysSince()
    Will determine the time between the last update and returns the number of days

Adjusted the life and ES radio buttons y value to use sections instead of raw subraction
    this may have been why there was an old report of the GUI becoming screwed up
    there should be no visible difference, but for those few it may solve the issue

Version .06.04 October/08/2019
--------------------------------------------------------------------------------
New flask keybindings to allow any key(s) to be pressed
    Assign the key for flask first with a space afterwards
    any letters or digits after the space will also fire at the same time
    Only the key in front of the space will be considered the flasks "key"
        This is for the passthrough timer to check if you manually use the flask
    A key with value of "3 Q R" will fire the number 3 as flask key and also fire Q & R
        these extra keys have no CD, use the utility section for that
        Make sure these abilities are instant if you are trying to cast more than one
    A key with a value of "e {RButton}" will fire the letter e and Right mouse
        Use the {} wrap on anything that needs to be spelled out

Added the ability to sell quality gems and flasks in bulk
    Will now group quality Flasks/Gems together in incriments of 40 quality
    Attempts to remove extra quality items and then vendors
    Turn on debug messages to see information about quality and extra Q

New option for Pop All Flasks
    When Pop Flasks Respect CD is disabled, you can have it only force cast flasks
    It will not fire any of the extra keys present in the bindings
        Enable "Pop Flasks Uses any extra keys" to force cast all keys in the binds
    When Pop Flasks Respect CD is enabled, it fires all bindings for flasks not on CD
        This includes any extra keys present in the flask bindings

Added Merge request for Cinematic ratio scaling (21:9)
    Thank to SamyBrom for the contribution of their datapoints
    I have not verified the positions, please report any issues.

Added a version check to the start of the script.
    Notifies you when you have an old version of AutoHotkey installed
    Takes you straight to the download page so you can update

Improvements to the Flasks and Utility tab
    moved things around a little and put into group boxes
    also moved the Auto-Mine function here and added to profiles
    Moved the QS settings together into a groupbox

Version .06.03 October/04/2019
--------------------------------------------------------------------------------
Improvements to the script messaging system, mostly streamlined code
    Removed the need to put the default script to each call
    Debug message added instead of Popup box for when it doesn't match

Version .06.02 October/03/2019
--------------------------------------------------------------------------------
Added new option to the Inventory Tab named Group Items before Stashing?
    Allows the script to go through all the inventory before Stashing
    This is a drastic increase in speed for the stash portion of inventory logic
    With a full inventory of various items its about 50% faster!
        Because it only switches stashes once per type instead of for each item
    Unique logic is the only exception, since it has 2 alternate tabs
        GIbS Enabled or disabled, uniques always stash right away
    Was suggested by SauronDev, thanks for the input!

Added threshold to mana %
    Will need to rework the GUI to be more clear, but for now is working
    0 threshold is ~10% mana, 100 is ~95% mana
    So if you want the old function just leave it at 0

Version .06.01 October/02/2019
--------------------------------------------------------------------------------
Implimented request to change the quicksilver and mana flask to checkboxes
    This will now allow you to quickly unselect either mana or quicksilver

Fix for Parsing Item base which was missing magic item and superior items
    I have added a series of string splits to seperate their possible names
    This also fixed the ignore slots not matching with proper Width x Height

Fix the Loot vacuum getting caught in a left click
    also removed the mouse movement, looks more natural now

Updated Filterblade pack, fixed some missing black backgrounds
    Retiered everything based on price as well.

Adjustments to PoE Click library
    added LeftClick, which has replaced SwiftClick in most sections
    SwiftClick now has no sleep between down and up click

--------------------------------------------------------------------------------
Release Notes
--------------------------------------------------------------------------------
Version .06.00 September/29/2019
--------------------------------------------------------------------------------

********************************************************************************
******************* DO NOT AUTO UPDATE TO THIS VERSION *************************
********************************************************************************
******************* WILL CRASH ON LAUNCH IF MISSING LIB ************************
********************************************************************************
************ Either fresh install or unzip on top of script dir ****************
********************************************************************************

Redisigned the Item parse debug system into the new Item Info GUI
    You can quickly look at the price graphs of items and its parsed info
    It shows the Prop, Stats, and Affix arrays for use with custom loot filter
    The two graphs either show the Buy and Sell or the Value and Low Confidence
        Low confidence graphs are based on low volumes of trade

Added Calibration Wizard which will gather all the samples at once
    Gives step by step instructions while waiting for "A" keypress
    Cancel the Wizard by holding Escape when pressing "A"

Added Gamestate display GUI for testing Calibration
    This replaces most of the functions of the previous debug options
    GUI will remain AlwaysOnTop, so you can move around in game
    Gamestates that return true will light up green
    Gamestates that are false will show as red text
    Use the Check Inventory Grid button to get a readout of your slots

Debug messages is the last vestage of the old debug system
    Enable this to allow debug tooltips to display

Added tooltips to all the options on the Configuration tab
    A lot of people seem to have issues with getting the calibration done
        This will hopefully give some more direction to those having issues
    These tooltips along with the Wizard will help a lot of people

MatchNinjaPrice can recognizes 5link, 6link or less variants
    Enable the option to force a 6 link match in the Item Parse tab
    I will add the ability to graph the other prices on demand later

The script has been completely restructured
    Several non dependant functions have been moved into the Library.ahk file
    Functions have been moved around and grouped together where possible
    Labels have been added to most comments for top down view navigation

Added Class_CtlColors, StringReplaceN, str_getTailf, FileCheck, to library
    Class_CtlColors for managing GuiControls text and background colors
    StringReplaceN for truncating long lists of hex colors
    str_getTailf and FileCheck are for future project of parsing the client log

"Quivers" and "Flasks" have been added to Stats.ItemClass

Fixed bug related to chat hotkey bindings
    You can now disable any hotkey from the Stash hotkeys or the Chat hotkeys
    Now works as intended, any Hotkey with an Empty Key value will be skipped

Adjusted sleep timers for the unique stash logic again, should be working now
    Still seemed to sample the color too quickly

--------------------------------------------------------------------------------
Summary of Changes Since last release version:
--------------------------------------------------------------------------------
Using the ~ evaluator with custom loot filter can use | between each string
Import and Export your Custom Loot Filters, can also duplicate them
New ingame loot filter pack to use with Loot Vacuum
Ignored Slot system to skip positions of the inventory and items already clipped
New database parser for PoE.Ninja that grabs price info (1-7 days between updates)
Update League info from the POE servers by pressing Update Leagues in Item Parse tab
Tons of bugfixes and adjustments25

--------------------------------------------------------------------------------
Patch Notes
--------------------------------------------------------------------------------
Version .05.11 September/22/2019
--------------------------------------------------------------------------------
Added Ignored Inventory slots menu, open in the inventory tab
    Check any box which you want the inventory scanner to skip1-8
    Wisdom and Portal scroll locations are automatically skipped already
        The slots they occupy will not appear to be checked, but they are skipped

Reverted the ItemScan to only check for Empty Slots
    Reverted the need to check for variation from the sample colors 

Added BlackList array to remember which slots are occupied
    Using the IgnoredSlot array we create the BlackList each time we run ItemSort
    Each item is added to the blacklist using its Width and Height
        Report any item types that doesnt have an assigned Width x Height
    This should limit items to get clipped only ONCE
    The speed of the scanner is now the fastest it can get!

Calibration for Inventory Colors has been Reverted
    Mouseover, ID, and UnID are no longer required.
    Simply provide an empty inventory to calibrate!
        has been moved back into Gamestate Calibration section

Added Array_DeepClone library for cloning an array multiple arrays deep
    Ty to GeekDude for the code, only using part of the lib
    https://autohotkey.com/board/topic/85201-array-deep-copy-treeview-viewer-and-more/

Fixed sleep between sending Unique to stash and Checking if it is gone
    Was still moving to secondary tabs even when Item was gone

Next Patch will include Graphs for 6.0 with new interface for the item parse

Version .05.10 September/20/2019
--------------------------------------------------------------------------------
**Patch Requires Calibration of OnMenu**
    Open either the Atlas or Talent skills panel then calibrate OnMenu

**First Launch will take more time**
    It will download and condense the PoE.Ninja databases into one file
    The script is now loading a sizable database into memory compared to before.

Added new Tab to the Config GUI for the Item Parse system
    option for turning it off
    option for frequency of the database update
    option for League name
    button to update league info
    Todo GUI:
        provide new filters for chaos value and exalt value
        Make new hotkey just for clipping item

New XGraph Library has been installed which allows us to graph the plotpoints
    this will be part of the next patch.
    I have already gotten the test script showing working graphs

Changed OnAtlas to OnMenu
    Since this affects both Atlas and Talent skills panel

Improvements for parser
    Splits itemname into ItemName and ItemBase
    Corrupted included in list of props available
    Added GemLevel to list of Stats
    Encodes the variant for matching skillgems 
        "GemLevel"/"Quality""corrupted"
        "21/23c" is 21 level 23 quality corrupted gem
        anything < lvl 20 with < 15 quality will be matched as "20" version
            if lvl < 20 & quality > 15 it will be matched as "1/20" version
    There are other items in the database with variants undone
        beyond skillgems it doesn't match for variant

Added a new scraper to grab PoE League data
    This will auto-populate the dropdown list for choosing your league.
    You only grab the league info one time, then you manually update it.
        any fresh install will grab this automatically.
        this is to limit us pinging the PoE servers for data

Added a new scraper to grab PoE ninja chaos value data
    Items become flagged with Prop.ChaosValue and Prop.ExaltValue
    Currency and Fragments only have ChaosValue
    Graphs of information to come!

Parses these PoE.Ninja API: Currency, Fragment, Prophecy, DivinationCard, Map, 
    Essence, UniqueArmour, UniqueFlask, UniqueWeapon, UniqueAccessory, Beast,
    UniqueJewel, UniqueMap, SkillGem, Scarab, Oil, Incubator, Resonator, Fossil

Version .05.09 September/16/2019
--------------------------------------------------------------------------------
Increased stash list to 31 tabs, beyond that is unknown how it will behave

Custom loot filter GUI now remembers Maximized state and window position

Added Breachstone to parser with flags:
    Prop.BreachSplinter and Prop.SpecialType="Breachstone"

Can now hit escape to close any script GUI window

Added Numpad0 as default modifier for stash tab hotkeys
    This will allow typing with the Numpad keys normally
    only affects fresh install

Bugfix for Lootvacuum
    will no longer get stuck holding down left mouse button

Version .05.08 September/15/2019
--------------------------------------------------------------------------------
**Patch Requires Recalibration of Inventory**

Returned the Id/Vend/Stash to checking for Unidentified and Identified colors
    This should speed up the script drastically when dealing with inventory
    The most times an item should be clipped is twice
        Will eventually get this down to once by using Prop.Width and Prop.Height

Rewrote the Inventory calibration section
    It now samples two colors per Calibration
        Identified items and Empty slots
        UnIdentified items and Mouseover color
    This now requires much less setup from the User
    Now you only need ONE unid or red item, and ONE identified item 
        Any item that has a red background can be used for UnId
        Gems with too high requirements are useful for this (they have red backgrnd)
    Place the single item in the first slot of an empty inventory to calibrate
    Requires 1x1 items (An item which is only one slot wide and high)
    Input is blocked while running calibration for these

Added new function to compare a hex value to an array of hex values
    indexOfHex(hexVal, hexArr, fromIndex, variance)
    default is variance of 2

Reclip items after they become identified.

Adjusted delays in SwiftClick, ShiftClick and CtrlClick by +15ms
    allow the button to register being released
    most delays are standardized now

Adjusted default values for INI read of Chat and Stash hotkeys prefix
    Now properly loads blank values when fresh install

Adjusted ItemSort to add delay before resampling Unique items
    Makes sure that the item has a chance to leave inventory
    This now works as intended, if not transfered it attempts next tab
        Tab Priority:
        Collection tab > Unique Ring Tab (if ring) > Unique Dump tab

Version .05.07 September/14/2019
--------------------------------------------------------------------------------
forgot to fix overlap on the calibration section

Version .05.06 September/14/2019
--------------------------------------------------------------------------------
Bugfix for AlternateGemY not being loaded properly
Added request for OnAtlas state
    thank you for the contributions danmarzola
    they have been helping to point out typos in the code

Added hex color comparison function for later use
    ToRGB(hexcolorVar) and CompareHex(rgbVar1,rgbVar2,varianceNum)

Version .05.05 September/13/2019
--------------------------------------------------------------------------------
Added PseudoTotalResist and PseudoTotalEleResist to affixes
Prop.Width and Prop.Height default to 1 now

Updated FilterBlade zip for the last few background colors to Black
    to updated these you need to manually extract them to their correct location
    C:\Users\  UserName  \Documents\My games\Path of Exile

Removed the icon file for GGF as it is no longer needed
    Removed the load lines for tray icon from GottaGoFast
    
Version .05.04 September/12/2019
--------------------------------------------------------------------------------
Bugfix patch
    Fix amulets being flagged as scarab

Version .05.03 September/12/2019
--------------------------------------------------------------------------------
Bugfix patch
    Fix missing BeltBases global
    
Version .05.02 September/12/2019
--------------------------------------------------------------------------------
Added the ability to match mutliple strings in one Group item
    Using the ~ evaluator you can now use | between each string
    so wand|shield will match for Wands or Shields in Stats.ItemClass
    it will remove extra spaces so you can use: wand | shield | body armour

Added the ability to import and export the JSON strings
    Import and Export directly from the Clipboard
    You can share these JSON strings on the forum!
        Lets see what people can come up with
        I will add them to wiki for examples
    Added the ability to duplicate the Group directly from export
        Click the export button then click duplicate

Added dropdownlist for setting default stashtab in LootFilter
    Saves to its own INI in the data folder

Version .05.01 September/11/2019
--------------------------------------------------------------------------------
added missing failsafe checks for utility buttons
    Will no longer fire Utility when on Chat, Hideout, Inventory or not on Char
    Misnamed KeyUtility1-5

added belt type to Stats.ItemClass as "Belts"
    Also can now use to match "Amulets" and "Rings"
    This requires a JSON file to download, check error log for issues

Added status check the moment before firing Life/ES flask to confirm if still OnChar
    This should fix the issue with flasks firing on the instance management panel
    Instance management calibration has been removed as it is not required

Version .05.00 September/11/2019
--------------------------------------------------------------------------------
Custom loot filter is a GO!
    The button to open the management script is on Inventory Tab
    Use the management script to edit or add to your loot filters
    Add to either Affixes, Props, or Stats for the filter rule
        Most exotic affixes are missing
    Choose the type of evaluation between >,<,=,!=,~
        ~ is to see if the min value is contained in the string
    Set the stash tab where the item will be sent
    Use the Debug tool to scan items with ItemParser checked

Added Base Armour and Weapon lists from PoE-TradeMacro
    Using it to gather Height, Width and Item Class

Armour Item Class:
    Body Armours
    Boots
    Gloves
    Helmets
    Shields

Weapon Item Class:
    Bows
    Claws
    Daggers
    Fishing Rods
    One Hand Axes
    One Hand Maces
    One Hand Swords
    Rune Dagger
    Sceptres
    Staves
    Thrusting One Hand Swords
    Two Hand Axes
    Two Hand Maces
    Two Hand Swords
    Wands
    Warstaff

If you want to match for just one handed 
    Stats.ItemClass is the key to match against
    use ~ as the evaluator
    In min put "one hand"
    same for any string you want to only match part of

Adjustments to the display of debug messages for controllers
    if controller support is turned off, no debug messages will display

Adjusted rescale to include OnHideoutMin in GottaGoFast
    also adjusted OnHideout location to match

Version .04.9 September/08/2019
--------------------------------------------------------------------------------
Updated stash tabs for latest patch
    Timeless splinter items are now handled under Fragments
    Oils have been added to the list of stash tabs in their place

Added Oils to item parser

Added New Minimized Hideout bar to GuiStatus
    Moved the hideout pixel spot 
    Dont forget to recalibrate!

Bugfix for Movestash
    fixed issue where it opens chat (longer delay after hitting enter)
    Fixed issue with tab names being too small

Bugfix for Inventory button
    Replaced Critical with Thread, NoTimers, true
        did same for all instances where Critical was used
    this fixes issues with hotkeys being qued back to back
    you can once again stop the inventory function by repressing the hotkey
    also seems to be back at full speed

Bugfix for Stock Wisdom and Portal 
    the checkboxes were not saved properly

Bugfix for chat hotkeys
    Can now use the symbol ! to punctuate messages

Removed unnecessary QHD scale section.

Preparing to add Custom loot filter for next major release!

Version .04.8 August/28/2019
--------------------------------------------------------------------------------
Adjustments for the dpad movement, makes it feel less sluggish
    it speeds up just slightly faster now and begins faster

bugfix for controller hotkeys, now can use symbol modifiers properly
    Use ! # ~ ^ * + symbols to apply appropriate modifiers.
    Used this to make button one Ctrl+LButton, seems to work well.
    still working on a way to do either regular click or shift or ctrl

Fix for controller joystick drifting
    adjustments to joystick thresholds to prevent false positives
    
Itemsort function now opens inventory if it is not already open
    this allows one button to act as inventory and also sort for controllers

   ############## Critical Update ###############
Updating to this version is required to autopatch to any further version.

Adding JSON library for next patch.
    without having a way to install it before the #Include JSON.ahk it will crash
    
Next release will include Custom loot filters!
    You can choose what items go into stash based on affixes and stats!
    Prevent the script from vendoring epic gear!

Version .04.7 August/21/2019
--------------------------------------------------------------------------------
Introducing Controller support!
    movement on the Joystick with optional utility key
    Move the mouse cursor with the D-Pad
    Aiming for spells with the second joystick and assigned key
    Keybindings for each button 1-10
    Use the key dropdown boxes to choose a script function, or an ingame key
    Lootvacuum on the controller by assigning the loot pickup key
    Key thing to note:
        Press load to redetect joysticks
        Disconnecting an active controller requires a script reload
        There is nothing I can do about this, AHK does not detect removal
        buttons are configured for default keybinds, match to your style

Added new option to return toggles to their previous state on load.
    Select Persistant Auto-Toggles in the Configuration tab

Added Instance Management screen and Divination trade window to failsafe colors.
    hit the OnInsMan Color button while instance manager is open
    hit the OnDiv Color button while divination trade window is open

Added option to inventory tab to turn on and off Divination trading
    Open the divination trade window and press the one button inventory hotkey!
    all full stack divination cards will be attempted to trade.
    currently does not have any way of determining if successful. 

Added in keyboard movement!
    optional keys to move up down left or right with utility key tied to it
    find these keys on controller tab for now

Bugfix for loot vacuum
    was not using the areascale calculations properly
    now searches in a small square near mouse
    (Was searching in 1 pixel area before)

Version .04.6 August/17/2019
--------------------------------------------------------------------------------
Bugfix for QSonMainAttack - was double casting the flasks and not respecting CD
Bugfix for AutoUpdate - needed to create data folder or it would fail to DL

Hopefully this should fix all issues with current version. 

Version .04.5 August/16/2019
--------------------------------------------------------------------------------
Added all the Vanilla Affixes to the item parser
    Integrated the Databases from PoE-TradeMacro for lab enchants and Corruptions
    Added Talisman corruptions to the table of possible corruption affixes
    Can handle double corrupted items
    This is the first step towards loot filtering and crafting bench functions

Added variables for firing QS on attack keys
    Also reworked the delay to support all three
    Modify the Quicksilver Flask Delay in the menu (Blank or 0 = instant)
    These variables are saved and loaded with profiles

Renamed the GetMouseCoords function to CoordAndDebug
    ReWork output of the debug tool, will only show popup when clipped an item
    Otherwise will show a 10 second long tooltip, this lets the item grid start
    Will only show weapon stats when clipping a weapon
    Will only show armour stats when clipping an armour
    Will only show relevant affixes and properties (Only things that are true)
    
All hotkeys now check if the game is open before firing.

Adjustments to the Chat hotkeys section.
    Added Dropdown box for chat command defaults
    Added a second tab structure inside the Chat tab
    added text replacement to the whisper reply as well

Bugfixes for QSonMainAttack portion that was added
    did not catch this bug until it was released, will need to skip version numbers

Version .04.2 August/13/2019
--------------------------------------------------------------------------------
Added RecipientName variable for command Functions
    Add RecipientName to any command to replace with last name replied to
    adjusted some of the default boxes to show uses

 Reworked the Stash tab hotkeys, they are now in the Inventory Tab
    Using the same method of multiple modifier hotkeys
    Assign modifiers and keys to go to assigned stash tab
    Default hotkeys are now the numpad 1-9 keys
    Keys assigned to these hotkeys will pass through to Interface
    These keys will not do anything if you are not at stash

 Adjustment to GottaGoFast script load, attempting to fix rogue issues

 Fixed Chat Hotkeys not becoming unregistered when disabled from enabled.

 Added Weapon dps parsing to the backend, ItemProp now has these stats:
    TotalDps, AttackSpeed, PhysLo, PhysHi, IsWeapon, PhysMult, PhysDps, 
    EleDps, ChaosLo, ChaosHi, EleLo, EleHi, ItemLevel, TotalPhysMult, 
    BasePhysDps, Q20Dps
    
Version .04.1 August/12/2019
--------------------------------------------------------------------------------
New Chat tab with customizable hotkeys
    Added two Hotkey sections which are for commands and reply whispers
    modifier editboxes can be blank or 1 or 2 modifier keys
    the keys themselves can also have modifiers such as ^ ! + or #
    this allows you to put a maximum modifier of 8 keys! XD
        Rediculous Example: Modifiers: A, D Keys: ^!+#1 & ^!+#2
        A and D together would activate Ctrl+Alt+Shift+Win+( 1 & 2 )
    Command section is a regular Enter and the Reply Whisper are Ctrl+Enter

Added new editbox for associating a character name with each profile
    You can insert this variable into any command with CharacterName
    mostly this is for using with /kick CharacterName

Updated some elements of UI to use sections
    will be replacing UI portions with outlined sections
    also makes the whole piece move together easier
    
Fixed hotkeys remaining in effect after being changed until next restart.
    Simply needed to move the hotkey reset BEFORE the gui is submit

Had to rewrite how the script checks if you press flasks for the passthrough
    now it is on a very short timer that just checks the state of 1-5

--------------------------------------------------------------------------------
Release Notes .04 August/10/2019
--------------------------------------------------------------------------------

Since the last release there has been a lot of work done to the script!

Backend improvements to how the script handles your settings, as well as making
profiles easier to use and centralizing all the relevant settings. With the 
introduction of the utility section I figured it was time to move it around.
Also how it handles Mana and Quicksilver flasks has been vastly improved. Now it
creates a list of all the flasks that are off cooldown, and goes through the list
in order when the previous one finishes cooldown.

People using scaled versions of the script should see improvements with how the
inventory sort function works. Sauron-Dev has been testing on a scaled resolution
and added some great changes to how it determines empty inventory slots.

Additions
--------------------------------------------------------------------------------
Fully fleshed out Utility function
    5 Generic utility keys that can be configured to:
        Fire on cooldown if there are no combination of triggers below
        Trigger when pressing a Quicksilver
        Trigger when at 20-90% Life
        Trigger when at 20-90% ES

Utility Management has been added to profiles
    Configure Each utility for a specific build!
	Now with all the settings in one place that profiles save and load

Profiles which have not been used now act as a blank slate for the GUI
    Press the load # button on a slot you have not used to unselect everything

Sauron-Dev has added:
    New method of determining items in inventory, should now scale without issues
    New calibration button to determine empty item slots colors
    New function to return an index of matching values from an array
	New function to deal with strings and arrays

Using Sauron-Dev's additions
    Implimented the same changes for Mouseover color
    Added calibration button to determine Mouseover Colors

Added Ding() function for debugging
    Can take up to 7 lines of input strings
    These only show when debug is checked

Added a timer for checking if the attack key has been held down
    Good news for those builds that holds down one key *META CYCLONE*
	
Added option to turn off Auto-Update


UI Changes
--------------------------------------------------------------------------------
Re-Organized the Tabs of the GUI, combined several tabs together.
    All Flasks and Utilities related options are now presented together in one page
    Added a messagebox for explaining how to use the calibration buttons
        Open by pressing the ?

Hotkey, Calibration, Additional Interface, and Debug items moved to second tab

Added load button to Flask/Utility and Configuration page to reload saved settings
	Keep in mind that some sections of the options always save themselves to ini

Added purple color to Hybrid text


Bug-Fixes
--------------------------------------------------------------------------------
Fixed activating AutoQuit alone wouldnt start the main timer

Fixed AutoQuit variables in the main timer

Mana Flasks now Fire sequentially to prevent overlap.

Removed a lot of unnecessary loading and GUI altering.
    Several checkboxes have been added default checked state
    Editboxes do not need second application of the variable text
    Radiobuttons can be Checked by default as well

Set default INI settings straight from the ReadFromFile() in both scripts
    This should fix any further issues with loading from incomplete settings.ini

Fixed textbox being selected on update Popup

--------------------------------------------------------------------------------
Patch Notes
--------------------------------------------------------------------------------

Version .04 August/10/2019
--------------------------------------------------------------------------------
Added option to turn off auto-updates
    This will become checked if declining update
    It is located on Configuration tab in Aditional Interface Options

Finished touching up GUI for Utility

Adjustments to quicksilver ini load

Version .03.7 August/10/2019
--------------------------------------------------------------------------------
Added a timer for checking if the attack key has been held down
    Good news for those builds that holds down one key *META CYCLONE*

Added Ding() function for debugging
    Can take up to 7 lines of input strings
    These only show when debug is checked

Fixed activating AutoQuit alone wouldnt start the main timer
Fixed AutoQuit variables in the main timer

Version .03.6 August/09/2019
--------------------------------------------------------------------------------
Utility Management has been added to profiles
    Configure Each utility for a specific build!

Profiles which have not been used now act as a blank slate for the GUI
    Press the load # button on a slot you have not used to unselect everything

Fixed textbox being selected on update Popup

Version .03.5 August/09/2019
--------------------------------------------------------------------------------
Sauron-Dev has added:
    New method of determining items in inventory, should now scale without issues
    New calibration button to determine empty item slots colors
    New function to return an index of matching values from an array

Using Sauron-Dev's additions
    Implimented the same changes for Mouseover color
    Added calibration button to determine Mouseover Colors

Version .03.4 August/09/2019
--------------------------------------------------------------------------------
Rework of the utility section
    Now has 5 generic utility that can be configured to:
        Trigger when pressing a Quicksilver
        Trigger when at a certain Life or ES percent
        If other triggers are disabled, it will fire on cooldown.

Version .03.3 August/08/2019
--------------------------------------------------------------------------------
Re-Organized the Tabs of the GUI, combined several tabs together.
    All flask related options are presented together in one page
    Utilities are planned to be added to profiles, so moved them in
    Hotkey, Calibration, Additional Interface Options, and Debug items moved to "Configuration"
    Added a messagebox for explaining how to use the calibration buttons
        Open by pressing the ?

Version .03.2 August/07/2019
--------------------------------------------------------------------------------
Added load button to config page to reload saved settings

Version .03.1 August/07/2019
--------------------------------------------------------------------------------
Set default INI settings straight into the ReadFromFile()
    This should fix any further issues with loading from incomplete settings.ini

Removed a lot of unnecessary loading and GUI altering.
    Several checkboxes have been added default checked state
    Editboxes do not need second application of the variable text
    Radiobuttons can be Checked by default as well

Added purple color to Hybrid text

Mana Flasks Fire sequentially

Version .03 August/06/2019
--------------------------------------------------------------------------------
Created a new utility Function
    It can now be expanded to support any number of utilities
    Input Utility name and it manages all the cooldowns and keys.
    I put all the settings together for easily adding more.
    As of now, PhaseRun and VaalDiscipline are supported utility skills.

Cooldowns from main script will go directly to subscript
    The two scripts now have a way to communicate which flasks are on cooldown.

Script will not remove focus from game window.
    Now when Loading the script or pressing the save button, it will make
    the game window focused if the window exists.

Fixed the script from stealing focus from game.

added timer to tooltip on save, removes after 5s

Quicksilver flasks now fire sequentially without skipping!

Show on start option is now respected

Added link to Wiki page and donation to tray tip

Added auto-update function, will now be tracking version online.